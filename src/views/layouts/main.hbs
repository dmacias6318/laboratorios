<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.min.css.map">
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <!-- Bootstrap CSS -->
    <title>Hello, world!</title>
    <style>
        body {
    padding-top: 90px;
}
.panel-login {
	border-color: #ccc;
	-webkit-box-shadow: 0px 2px 3px 0px rgba(0,0,0,0.2);
	-moz-box-shadow: 0px 2px 3px 0px rgba(0,0,0,0.2);
	box-shadow: 0px 2px 3px 0px rgba(0,0,0,0.2);
}
.panel-login>.panel-heading {
	color: #00415d;
	background-color: #fff;
	border-color: #fff;
	text-align:center;
}
.panel-login>.panel-heading a{
	text-decoration: none;
	color: #666;
	font-weight: bold;
	font-size: 15px;
	-webkit-transition: all 0.1s linear;
	-moz-transition: all 0.1s linear;
	transition: all 0.1s linear;
}
.panel-login>.panel-heading a.active{
	color: #029f5b;
	font-size: 18px;
}
.panel-login>.panel-heading hr{
	margin-top: 10px;
	margin-bottom: 0px;
	clear: both;
	border: 0;
	height: 1px;
	background-image: -webkit-linear-gradient(left,rgba(0, 0, 0, 0),rgba(0, 0, 0, 0.15),rgba(0, 0, 0, 0));
	background-image: -moz-linear-gradient(left,rgba(0,0,0,0),rgba(0,0,0,0.15),rgba(0,0,0,0));
	background-image: -ms-linear-gradient(left,rgba(0,0,0,0),rgba(0,0,0,0.15),rgba(0,0,0,0));
	background-image: -o-linear-gradient(left,rgba(0,0,0,0),rgba(0,0,0,0.15),rgba(0,0,0,0));
}
.panel-login input[type="text"],.panel-login input[type="email"],.panel-login input[type="password"] {
	height: 45px;
	border: 1px solid #ddd;
	font-size: 16px;
	-webkit-transition: all 0.1s linear;
	-moz-transition: all 0.1s linear;
	transition: all 0.1s linear;
}
.panel-login input:hover,
.panel-login input:focus {
	outline:none;
	-webkit-box-shadow: none;
	-moz-box-shadow: none;
	box-shadow: none;
	border-color: #ccc;
}
.btn-login {
	background-color: #59B2E0;
	outline: none;
	color: #fff;
	font-size: 14px;
	height: auto;
	font-weight: normal;
	padding: 14px 0;
	text-transform: uppercase;
	border-color: #59B2E6;
}
.btn-login:hover,
.btn-login:focus {
	color: #fff;
	background-color: #53A3CD;
	border-color: #53A3CD;
}
.forgot-password {
	text-decoration: underline;
	color: #888;
}
.forgot-password:hover,
.forgot-password:focus {
	text-decoration: underline;
	color: #666;
}

.btn-register {
	background-color: #1CB94E;
	outline: none;
	color: #fff;
	font-size: 14px;
	height: auto;
	font-weight: normal;
	padding: 14px 0;
	text-transform: uppercase;
	border-color: #1CB94A;
}
.btn-register:hover,
.btn-register:focus {
	color: #fff;
	background-color: #1CA347;
	border-color: #1CA347;
}

    </style>
</head>

<body style="font-family:Arial, Helvetica, sans-serif;font-size:12px;height:100vh">
    <div class="container">
        {{{ body }}}
        
    </div>


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<script>
    jQuery(function() {

    $('#login-form-link').click(function(e) {
		$("#login-form").delay(100).fadeIn(100);
 		$("#register-form").fadeOut(100);
		$('#register-form-link').removeClass('active');
        $("#sucursal-form").fadeOut(100);
		$('#sucursal-form-link').removeClass('active');
		$(this).addClass('active');
		e.preventDefault();
	});
	$('#register-form-link').click(function(e) {
		$("#register-form").delay(100).fadeIn(100);
 		$("#login-form").fadeOut(100);
		$('#login-form-link').removeClass('active');
        $("#sucursal-form").fadeOut(100);
		$('#sucursal-form-link').removeClass('active');
		$(this).addClass('active');
		e.preventDefault();
	});
    $('#sucursal-form-link').click(function(e) {
		$("#sucursal-form").delay(100).fadeIn(100);
 		$("#login-form").fadeOut(100);
		$('#login-form-link').removeClass('active');
        $("#register-form").fadeOut(100);
		$('#register-form-link').removeClass('active');
		$(this).addClass('active');
		e.preventDefault();
	});



//------------------------------------------------------------------------------------------
//CREAR SUCURSAL
//------------------------------------------------------------------------------------------
$("#btn-sucursal").click(function(){
    var name  = $('#name').val();
    var direccion  = $('#direccion').val();
    var codigo  = $('#codigo').val();
    if(name=="" || direccion=="" || codigo=="" ){
        alert("debe completar todos los campos")
    }else{
     $("#btn-sucursal").attr('disabled',true);
     $("#btn-sucursal").html("<i class=''></i> CREANDO ..."); 
     registrarSucursal();

    }
})

 function registrarSucursal(){
    var name  = $('#name').val();
    var direccion  = $('#direccion').val();
    var codigo  = $('#codigo').val();
    
         $.ajax({
            url:'/resgistrarSucursal',
            type:'POST',
            dataType:'json',
            data:{name:name,direccion:direccion,codigo:codigo},
            success:function(response){
                  //loader_login('off');
                  console.log(response.sms)
                  if(response.sms=="ok"){
                   
                      toastr.options = {
                        "progressBar": false,
                        "timeOut": "2000",
                         }
                      toastr["success"]("La sucursal se registro con éxito !!", "Success:")
                      $("#btn-sucursal").attr('disabled',false);
                      $("#btn-sucursal").html("<i class=''></i> CREAR SUCURSAL"); 
                      $('#name').val("");
                      $('#direccion').val("");
                      $('#codigo').val("");
                    
                    
                  }else {
                    toastr.options = {
                      "progressBar": false,
                      "timeOut": "2000",
                       }
                    toastr["error"]("La contraseña no es la correcta !!", "Error:")
                     $("#btn-sucursal").attr('disabled',false);
                      $("#btn-sucursal").html("<i class=''></i> CREAR SUCURSAL"); 
                  }
                  
             }  
            });
        }



//------------------------------------------------------------------------------------------
//CREAR USUARIO
//------------------------------------------------------------------------------------------
$("#btn-usuario").click(function(){
    var email  = $('#email').val();
    var user  = $('#user').val();
    var nombres  = $('#nombres').val();
    var password  = $('#password').val();
    var fec_naci  = $('#fec_naci').val();
    if(email=="" || password=="" || fec_naci=="" || nombres=="" || user==""){
        alert("debe completar todos los campos")
    }else{
     $("#btn-usuario").attr('disabled',false);
     $("#btn-usuario").html("<i class=''></i> CREANDO"); 
     registrarUsuario();

    }
})

 function registrarUsuario(){
    var email  = $('#email').val();
    var password  = $('#password').val();
    var fec_naci  = $('#fec_naci').val();
    var user  = $('#user').val();
    var nombres  = $('#nombres').val();
    
         $.ajax({
            url:'/resgistrarUsuario',
            type:'POST',
            dataType:'json',
            data:{email:email,password:password,fec_naci:fec_naci,user:user,nombres:nombres},
            success:function(response){
                  //loader_login('off');
                  console.log(response.sms)
                  if(response.sms=="ok"){
                   
                      toastr.options = {
                        "progressBar": false,
                        "timeOut": "2000",
                         }
                      toastr["success"]("El usuario se registro con éxito !!", "Success:")
                      $("#btn-usuario").attr('disabled',false);
                      $("#btn-usuario").html("<i class=''></i> CREAR USUARIO"); 
                      $('#email').val("");
                      $('#password').val("");
                      $('#fec_naci').val("");
                    
                    
                  }else {
                    toastr.options = {
                      "progressBar": false,
                      "timeOut": "2000",
                       }
                    toastr["error"]("La contraseña no es la correcta !!", "Error:")
                     $("#btn-usuario").attr('disabled',false);
                      $("#btn-usuario").html("<i class=''></i> CREAR USUARIO"); 
                  }
                  
             }  
            });
        }




//------------------------------------------------------------------------------------------
//LOGIN
//------------------------------------------------------------------------------------------

$("#btn-login").click(function(){
    var user  = $('#username').val();
    var password  = $('#password').val();
    var sucursal  = $('#sucursal').val();
    if(user=="" || password=="" || sucursal=="0"){
        alert("debe completar todos los campos")
    }else{
     $("#btn-login").attr('disabled',false);
     $("#btn-login").html("<i class=''></i> Iniciando ..."); 
     login();

    }
})

 function login(){
    var user  = $('#username').val();
    var password  = $('#password').val();
    var sucursal  = $('#sucursal').val();
    
         $.ajax({
            url:'/login',
            type:'POST',
            dataType:'json',
            data:{password:password,user:user,sucursal:sucursal},
            success:function(response){
                  //loader_login('off');
                  //console.log(response.result[0])
                  if(response.sms=="ok"){
                                     
                    redirect("/gerencia")
                   }else if(response.sms=="nopass") {
                    toastr.options = {
                      "progressBar": false,
                      "timeOut": "2000",
                       }
                    toastr["error"]("La contraseña no es la correcta !!", "Error:")
                     $("#btn-login").attr('disabled',false);
                      $("#btn-login").html("<i class=''></i> Iniciar"); 
                  }else if(response.sms=="nouser") {
                    toastr.options = {
                      "progressBar": false,
                      "timeOut": "2000",
                       }
                    toastr["error"]("el usuario no es el correcto !!", "Error:")
                     $("#btn-login").attr('disabled',false);
                      $("#btn-login").html("<i class=''></i> Iniciar"); 
                  }else if(response.sms=="nosucursal") {
                    toastr.options = {
                      "progressBar": false,
                      "timeOut": "2000",
                       }
                    toastr["error"]("La sucursal no existe !!", "Error:")
                     $("#btn-login").attr('disabled',false);
                      $("#btn-login").html("<i class=''></i> Iniciar"); 
                  }
                  
             }  
            });
        }











 function redirect(url){
      window.location=url;
  }




});
</script>

</body>
<!--
     <script src="/socket.io/socket.io.js"></script>
     client: var socket = io();
-->